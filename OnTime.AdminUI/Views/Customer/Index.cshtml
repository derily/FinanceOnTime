
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}

<link rel="stylesheet" href="~/Content/Site.css"/>
<script type="text/javascript" language="javascript" src="//cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <div>
                <table id="jqGrid" style="width: 100%"></table>
                <div id="jqGridPager"></div>
                <!--<button id="export">Export to Excel</button>-->
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var $grid = $('#jqGrid');
    $(document).ready(function() {
        $("#jqGrid").jqGrid({
            url: '@Url.Action("GetList")',
            mtype: "GET",
            styleUI: 'Bootstrap',
            datatype: "json",
            colModel: [
                { label: '主键', name: 'Id', hidden: true },
                { label: '手机号码', name: 'PhoneNum' },
                { label: '股票代码', name: 'StockCode' },
                {label:'创建时间',name:'CreateTime',formatter:'date'}
            ],
            //beforeSelectRow: function (rowid, e) {
            //    return false;
            //},
            viewrecords: true,
            autowidth: true,
            height: '100%',
            rowNum: 20,
            pager: "#jqGridPager"
        });

        $("#export").on("click", function () {
            $("#jqGrid").jqGrid("exportToExcel", {
                includeLabels: true,
                includeGroupHeader: true,
                includeFooter: true,
                fileName: "jqGridExport.xlsx",
               // maxlength: 40 // maxlength for visible string data 
            })
        })
    });
</script>

